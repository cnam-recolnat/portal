#!/bin/bash
#-----------------------------------------------------------8<----------------------------------------------------------
service haproxy status && service haproxy start && service haproxy status && ps aux | grep haproxy
#-----------------------------------------------------------8<----------------------------------------------------------
cd etcd-v2.0.0-rc.1-linux-amd64 && nohup ./etcd &
#-----------------------------------------------------------8<----------------------------------------------------------
sleep 5
#-----------------------------------------------------------8<----------------------------------------------------------
nohup curl -L http://127.0.0.1:4001/v2/keys/myapp?wait=true\&recursive=true &
#-----------------------------------------------------------8<----------------------------------------------------------
sleep 1
#-----------------------------------------------------------8<----------------------------------------------------------
cat /tmp/myconfig.conf
#-----------------------------------------------------------8<----------------------------------------------------------
curl -L -X PUT http://127.0.0.1:4001/v2/keys/myapp/database/url -d value="db.example.com"
curl -L -X PUT http://127.0.0.1:4001/v2/keys/myapp/database/user -d value="rob"
#-----------------------------------------------------------8<----------------------------------------------------------
confd -onetime -backend etcd -node 127.0.0.1:4001
#-----------------------------------------------------------8<----------------------------------------------------------
cat /tmp/myconfig.conf
#-----------------------------------------------------------8<----------------------------------------------------------
echo "root:abracadabra" | chpasswd
exec /usr/sbin/sshd -D
#-----------------------------------------------------------8<----------------------------------------------------------